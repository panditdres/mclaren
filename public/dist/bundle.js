"use strict";!function(){angular.module("McLarenApp",["ui.router","ui.bootstrap","ngStorage","angular-loading-bar","ngMessages","ngFileSaver","ngToast","chart.js"]).config(["$logProvider","$compileProvider","$urlRouterProvider","$locationProvider","cfpLoadingBarProvider",function(t,e,n,a,r){n.otherwise("/"),t.debugEnabled(!1),a.html5Mode(!0),r.includeSpinner=!1,e.debugInfoEnabled(!1)}]).controller("AppCtrl",["$scope","$localStorage","$location","$sessionStorage",function(t,e,n,a){var r=n.search().SessionID;r&&(e.token=r),a.$reset(),t.$on("$stateChangeSuccess",function(e,n,a,r,i){angular.isDefined(n.data.pageTitle)&&(t.pageTitle=n.data.pageTitle+" | McLaren")})}])}(),function(){function t(t,e,n,a){function r(){return t.get(o+"allPatients").then(function(t){return u=t.data.data,t.data}).catch(function(t){})}function i(){return t.get(o+"allDefinitions").then(function(t){return l=t.data.data,t.data}).catch(function(t){})}var o="/api/v1/",u=[],l=[];return{getAllPatients:r,getAllDefinitions:i,patients:function(){return u},definitions:function(){return l}}}t.$inject=["$http","$q","$localStorage","ngToast"],angular.module("McLarenApp").factory("DataService",t)}(),angular.module("McLarenApp").controller("ModalCtrl",["$scope","$uibModalInstance","DataService","ngToast",function(t,e,n,a){var r=this;t.modal=e,function(){r.patient=t.$resolve.obj.patient,r.definitions=t.$resolve.obj.definitions,r.patient.summary.forEach(function(t){t.activity=t.activity.replace(/\b\w/g,function(t){return t.toUpperCase()})}),r.labels=r.patient.summary.map(function(t){return t.activity}),r.data=r.patient.summary.map(function(t){return t.minutes}),r.chartOptions={cutoutPercentage:70},r.moderateTotal=r.patient.moderateTotal,r.vigorousTotal=r.patient.vigorousTotal,r.moderateTotal>=150&&0===r.vigorousTotal?r.resultText="Patient falls under the category of 150 minutes of moderate activity":r.vigorousTotal>=75&&0===r.moderateTotal?r.resultText="Patient falls under the category of 75 minutes of vigorous activity":0!=r.vigorousTotal&&0!=r.moderateTotal?r.resultText="Patient falls under the category of a mix of moderate and vigorous activity":r.resultText="Patient lacks activity"}()}]),function(){angular.module("McLarenApp").config(["$stateProvider",function(t){t.state("home.grid",{url:"/",controller:"GridCtrl as vm",templateUrl:"app/grid/grid.html",data:{pageTitle:"Dashboard"}})}]).controller("GridCtrl",["$scope","$state","$uibModal","$filter","$rootScope","DataService",function(t,e,n,a,r,i){function o(){if(s.patients){var t=a("filter")(u(s.patients),s.search),e=t.filter(function(t,e){return e>=s.pplPerPage*(s.pageNum-1)&&e<s.pageNum*s.pplPerPage});return s.pageLen=t.length,e}}function u(t){var e=t.map(function(t,e){return{index:e,value:t[s.sortCol]}});return e.sort(function(t,e){return t.value>e.value?s.sortReverse?-1:1:t.value<e.value?s.sortReverse?1:-1:0}),e.map(function(e){return t[e.index]})}function l(e){var a={patient:e,definitions:s.definitions},r={templateUrl:"app/templates/modal.html",size:"lg",controller:"ModalCtrl as vm",scope:t,resolve:{obj:a}};n.open(r).result.then(function(t){},function(){})}var s=this;s.search="",s.sortCol="name",s.checkboxAll=!1,s.pageNum=1,s.sortReverse=!1,s.pplPerPage=10,s.pagePatients=o,s.viewPatient=l,s.gridColumns=[{display:"Name",search:"name",sort:"name",rotate:"name"},{display:"BMI",search:"bmi",sort:"bmi",rotate:"bmi"},{display:"Height (cm)",search:"heightCm",sort:"heightCm",rotate:"heightCm"},{display:"Weight (kg)",search:"weightKg",sort:"weightKg",rotate:"weightKg"},{display:"Category",search:"resultText",sort:"resultText",rotate:"resultText"},{display:"Created",search:"Created",sort:"Created",rotate:"Created"}],function(){s.patients=i.patients(),s.definitions=i.definitions();var t=s.definitions.filter(function(t){return"vigorous"===t.intensity}).map(function(t){return t.activity}),e=s.definitions.filter(function(t){return"moderate"===t.intensity}).map(function(t){return t.activity});s.patients.forEach(function(n){n.moderateTotal=n.summary.filter(function(t){return e.includes(t.activity.toLowerCase())}).map(function(t){return t.minutes}).reduce(function(t,e){return t+e},0),n.vigorousTotal=n.summary.filter(function(e){return t.includes(e.activity.toLowerCase())}).map(function(t){return t.minutes}).reduce(function(t,e){return t+e},0),n.moderateTotal>=150&&0===n.vigorousTotal?n.resultText="150 minutes of moderate activity":n.vigorousTotal>=75&&0===n.moderateTotal?n.resultText="75 minutes of vigorous activity":0!=n.vigorousTotal&&0!=n.moderateTotal?n.resultText="Mix of moderate and vigorous activity":n.resultText="Lacks activity"})}()}]).directive("customOnChange",function(){return{restrict:"A",link:function(t,e,n){var a=t.$eval(n.customOnChange);e.bind("change",a),e.on("$destroy",function(){e.unbind("change")})}}})}(),function(){angular.module("McLarenApp").config(["$stateProvider",function(t){t.state("home",{controller:"HomeCtrl as vm",templateUrl:"app/home/home.html",data:{pageTitle:"Dashboard"},resolve:{allPatients:["DataService",function(t){return t.getAllPatients().then(function(t){return t.data})}],allDefinitions:["DataService",function(t){return t.getAllDefinitions().then(function(t){return t.data})}]}})}]).controller("HomeCtrl",["$scope","$localStorage","$state","DataService","allPatients","allDefinitions",function(t,e,n,a,r,i){var o=this;!function(){o.patients=r,o.definitions=i}()}])}();