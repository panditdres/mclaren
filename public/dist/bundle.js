"use strict";!function(){angular.module("McLarenApp",["ui.router","ui.bootstrap","ngStorage","angular-loading-bar","ngMessages","ngFileSaver","ngToast","chart.js"]).config(["$logProvider","$compileProvider","$urlRouterProvider","$locationProvider","cfpLoadingBarProvider",function(t,e,n,a,o){n.otherwise("/"),t.debugEnabled(!1),a.html5Mode(!0),o.includeSpinner=!1,e.debugInfoEnabled(!1)}]).controller("AppCtrl",["$scope","$localStorage","$location","$sessionStorage",function(t,e,n,a){var o=n.search().SessionID;o&&(e.token=o),a.$reset(),t.$on("$stateChangeSuccess",function(e,n,a,o,r){angular.isDefined(n.data.pageTitle)&&(t.pageTitle=n.data.pageTitle+" | McLaren")})}])}(),function(){function t(t,e,n,a){function o(){return t.get(i+"allPatients").then(function(t){return l=t.data.data,t.data}).catch(function(t){console.log(t)})}function r(){return t.get(i+"allDefinitions").then(function(t){return s=t.data.data,t.data}).catch(function(t){console.log(t)})}var i="/api/v1/",l=[],s=[];return{getAllPatients:o,getAllDefinitions:r,patients:function(){return l},definitions:function(){return s}}}t.$inject=["$http","$q","$localStorage","ngToast"],angular.module("McLarenApp").factory("DataService",t)}(),angular.module("McLarenApp").controller("ModalCtrl",["$scope","$uibModalInstance","DataService","ngToast",function(t,e,n,a){var o=this;t.modal=e,function(){console.log("Modal created"),o.patient=t.$resolve.obj.patient,o.definitions=t.$resolve.obj.definitions,o.patient.summary.forEach(function(t){t.activity=t.activity.replace(/\b\w/g,function(t){return t.toUpperCase()})}),o.labels=o.patient.summary.map(function(t){return t.activity}),o.data=o.patient.summary.map(function(t){return t.minutes}),o.chartOptions={cutoutPercentage:70},o.moderateTotal=o.patient.moderateTotal,o.vigorousTotal=o.patient.vigorousTotal,o.moderateTotal>=150&&0===o.vigorousTotal?o.resultText="Patient falls under the category of 150 minutes of moderate activity":o.vigorousTotal>=75&&0===o.moderateTotal?o.resultText="Patient falls under the category of 75 minutes of vigorous activity":0!=o.vigorousTotal&&0!=o.moderateTotal?o.resultText="Patient falls under the category of a mix of moderate and vigorous activity":o.resultText="Patient lacks activity"}()}]),function(){angular.module("McLarenApp").config(["$stateProvider",function(t){t.state("home.grid",{url:"/",controller:"GridCtrl as vm",templateUrl:"app/grid/grid.html",data:{pageTitle:"Dashboard"}})}]).controller("GridCtrl",["$scope","$state","$uibModal","$filter","$rootScope","DataService",function(t,e,n,a,o,r){function i(){if(u.patients){var t=a("filter")(l(u.patients),u.search),e=t.filter(function(t,e){return e>=u.pplPerPage*(u.pageNum-1)&&e<u.pageNum*u.pplPerPage});return u.pageLen=t.length,e}}function l(t){var e=t.map(function(t,e){return{index:e,value:t[u.sortCol]}});return e.sort(function(t,e){return t.value>e.value?u.sortReverse?-1:1:t.value<e.value?u.sortReverse?1:-1:0}),e.map(function(e){return t[e.index]})}function s(e){var a={patient:e,definitions:u.definitions},o={templateUrl:"app/templates/modal.html",size:"lg",controller:"ModalCtrl as vm",scope:t,resolve:{obj:a}};n.open(o).result.then(function(t){console.log("closed modal result returned")},function(){console.log("Modal dismissed")})}var u=this;u.search="",u.sortCol="name",u.checkboxAll=!1,u.pageNum=1,u.sortReverse=!1,u.pplPerPage=10,u.pagePatients=i,u.viewPatient=s,u.gridColumns=[{display:"Name",search:"name",sort:"name",rotate:"name"},{display:"BMI",search:"bmi",sort:"bmi",rotate:"bmi"},{display:"Height (cm)",search:"heightCm",sort:"heightCm",rotate:"heightCm"},{display:"Weight (kg)",search:"weightKg",sort:"weightKg",rotate:"weightKg"},{display:"Category",search:"resultText",sort:"resultText",rotate:"resultText"},{display:"Created",search:"Created",sort:"Created",rotate:"Created"}],function(){u.patients=r.patients(),u.definitions=r.definitions();var t=u.definitions.filter(function(t){return"vigorous"===t.intensity}).map(function(t){return t.activity}),e=u.definitions.filter(function(t){return"moderate"===t.intensity}).map(function(t){return t.activity});u.patients.forEach(function(n){n.moderateTotal=n.summary.filter(function(t){return e.includes(t.activity.toLowerCase())}).map(function(t){return t.minutes}).reduce(function(t,e){return t+e},0),n.vigorousTotal=n.summary.filter(function(e){return t.includes(e.activity.toLowerCase())}).map(function(t){return t.minutes}).reduce(function(t,e){return t+e},0),n.moderateTotal>=150&&0===n.vigorousTotal?n.resultText="150 minutes of moderate activity":n.vigorousTotal>=75&&0===n.moderateTotal?n.resultText="75 minutes of vigorous activity":0!=n.vigorousTotal&&0!=n.moderateTotal?n.resultText="Mix of moderate and vigorous activity":n.resultText="Lacks activity"})}()}]).directive("customOnChange",function(){return{restrict:"A",link:function(t,e,n){var a=t.$eval(n.customOnChange);e.bind("change",a),e.on("$destroy",function(){e.unbind("change")})}}})}(),function(){angular.module("McLarenApp").config(["$stateProvider",function(t){t.state("home",{controller:"HomeCtrl as vm",templateUrl:"app/home/home.html",data:{pageTitle:"Dashboard"},resolve:{allPatients:["DataService",function(t){return t.getAllPatients().then(function(t){return t.data})}],allDefinitions:["DataService",function(t){return t.getAllDefinitions().then(function(t){return t.data})}]}})}]).controller("HomeCtrl",["$scope","$localStorage","$state","DataService","allPatients","allDefinitions",function(t,e,n,a,o,r){var i=this;!function(){i.patients=o,i.definitions=r}()}])}();